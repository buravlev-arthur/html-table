## Оптимизация

### HTML
1. Рендерить количество ячеек пропорциональное размеру экрана пользователя (viewport);
2. Одновременно рендерить вторую "страницу" ячеек для вертикального скроллигна таблицы
без необходимости одновременно рендерить новые элементы;
3. Фиксировать вертикальный скроллинг таблицы с помощью двух [Intersection Observer](https://developer.mozilla.org/ru/docs/Web/API/Intersection_Observer_API)'ов
вверху и внизу отображаемой области таблицы (их пересечение со строками таблицы);
4. Использовать абсолютное позиционирование элементов: `position: absolute`;
5. Для динамического позиционирования ячейки использовать css-свойство: `transform: translateY(0px)`;
6. Для отображения новых строк **не удалять** скрываемые ячейки, а вместо этого:
    - изменять их контент: `element.textContent = 'new value'`;
    - изменять значения атрибутов `data-row` и `data-cell`;
    - изменять их позицию по оси Y с помощью свойства `translateY` (пункт 5).

### CSS
1. Использовать соглашения по именованию css-классов и минифицировать css-бандлы при сборке;

### JS
1. Разрешение зависимостей в формулах ячеек и их вычисление делегировать [веб-воркеру](https://developer.mozilla.org/ru/docs/Web/API/Web_Workers_API/Using_web_workers);
2. Применять асинхронный стиль кода;
3. Для обновления данных ячеек использовать _Lazy DOM Updating_ (?);

## Парсинг формулы в ячейке

1. Разрешить зависимости (получить значения из указанных в формуле ячеек).
Воспользоваться алгоритмом [Топологической сортировки](https://ru.wikipedia.org/wiki/%D0%A2%D0%BE%D0%BF%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D1%81%D0%BE%D1%80%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0).
Если обнаруживается циклическая зависимость ячеек - прекращать алгоритм и выводить ошибку;
2. Подставить полученные значения в формулу ячейки;
3. Разобрать формулу на составные функции с помощью [Алгоритма сортировочной станции](https://ru.wikipedia.org/wiki/%D0%90%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC_%D1%81%D0%BE%D1%80%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%BE%D1%87%D0%BD%D0%BE%D0%B9_%D1%81%D1%82%D0%B0%D0%BD%D1%86%D0%B8%D0%B8);
4. Записать полученное значение в поле объекта ячейки: `calculatedValue`.

## Хранение данных

Для хранения данных таблицы используется плоский Map:
```typescript
// Ключ: "row_cell", например: "12_6"
// Значение: объект с данными ячейки SheetCell
const sheetState = new Map<string, SheetCell>();

type SheetCell = {
    formula: string; // то, что ввел пользователь в ячейку
    calculatedValue?: string; // полученное значение после парсинга формулы в ячейке
    type: SheetCellType; // тип ячейки: дата, число, строка и т.д.
    formating: SheetCellFormatOption[]; // набор правил форматирования ячейки (жирный, курсив и т.п.)
}

type SheetCellType = 'Date' | 'String' | 'Number';

// Enum позволяет состоянию не зависить от конкретной реализации классов форматирования
enum SheetCellFormatOption {
    'BOLD',
    'ITALIC',
    'UNDERLINED'
}
```

## Регистрация события изменения ячейки

Достаточно регистрировать событие один раз - в родительском элементе таблицы.
Идентифицировать измененную ячейку можно по атрибутам `data-row`, `data-cell`.

```html
<!-- Механизм всплытия "поднимет" события клика по ячейке к родительскому элементу таблицы-->
<div id="sheet-list" onclick="onCellChange(this, event)">
    <div data-row="12" data-cell="6">...</div>
</div>
```

```typescript
function onCellChange(element: HTMLDivElement, event: MouseEvent): void {
    // получаем строку и номер измененной ячейки
    const row = event.target.attributes['data-row'].value;
    const cell = event.target.attributes['data-row'].value;
    console.log(row, cell);
}
```

## Доступность

1. По возможности использовать нативные элементы: `table`, `tr`, `td`;
2. Если используются div-элементы, применять к ним [ARIA-roles](https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Reference):
grid, row, cell, rowgroup, columnheader;
3. Использовать `rem`-единицы вместо `px`, для корректного масштабирования интерфейса
при нестандартных пользовательских настройках;
4. Реализовать набор комбинаций горячих клавиш и поиск по их аннотации.
